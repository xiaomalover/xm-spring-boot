(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25f4e37a"],{"478c":function(t,e,a){},e007:function(t,e,a){"use strict";a("478c")},e8b1:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("Row",[a("Col",[a("Card",[a("Row",[a("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:t.searchForm,inline:"","label-width":70}},[a("Form-item",{attrs:{label:"标题",prop:"title"}},[a("Input",{staticStyle:{width:"200px"},attrs:{type:"text",clearable:"",placeholder:"请输入文章标题"},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),a("Form-item",{attrs:{label:"是否展示",prop:"status"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择是否展示",clearable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[a("Option",{attrs:{value:"0"}},[t._v("否")]),a("Option",{attrs:{value:"1"}},[t._v("是")])],1)],1),a("Form-item",{attrs:{label:"分类",prop:"category"}},[a("Cascader",{staticStyle:{width:"200px"},attrs:{data:t.category,"load-data":t.loadData,"change-on-select":"",filterable:"",placeholder:"请选择或输入搜索分类"},on:{"on-change":t.handleChangeDep},model:{value:t.selectDep,callback:function(e){t.selectDep=e},expression:"selectDep"}})],1),a("Form-item",{attrs:{label:"创建时间"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",format:"yyyy-MM-dd",clearable:"",placeholder:"选择起始时间"},on:{"on-change":t.selectDateRange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1),a("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("Button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1),a("Row",{staticClass:"operation"},[a("Button",{directives:[{name:"has",rawName:"v-has",value:"add",expression:"'add'"}],attrs:{type:"primary",icon:"md-add"},on:{click:t.add}},[t._v("新增文章")]),a("Button",{directives:[{name:"has",rawName:"v-has",value:"delete",expression:"'delete'"}],attrs:{icon:"md-trash"},on:{click:t.delAll}},[t._v("批量删除")]),a("Dropdown",{on:{"on-click":t.handleDropdown}},[a("Button",[t._v("\n                            更多操作\n                            "),a("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),a("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[a("DropdownItem",{attrs:{name:"refresh"}},[t._v("刷新")]),a("DropdownItem",{attrs:{name:"exportData"}},[t._v("导出所选数据")]),a("DropdownItem",{attrs:{name:"exportDataAll"}},[t._v("导出全部数据")])],1)],1),a("Dropdown",{staticStyle:{float:"right"},on:{"on-click":t.handleDropdown}},[a("Button",[t._v("\n                            设置显示列\n                            "),a("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),a("DropdownMenu",{staticStyle:{padding:"10px"},attrs:{slot:"list"},slot:"list"},[a("Checkbox-group",{on:{"on-change":t.changeTableColumns},model:{value:t.tableColumnsChecked,callback:function(e){t.tableColumnsChecked=e},expression:"tableColumnsChecked"}},t._l(t.allColumns,(function(e){return a("Checkbox",{key:e.key,attrs:{label:e.key}},[t._v(t._s(e.title))])})),1)],1)],1)],1),a("Row",[a("Alert",{attrs:{"show-icon":""}},[t._v("\n                        已选择 "),a("span",{staticClass:"select-count"},[t._v(t._s(t.selectCount))]),t._v(" 项\n                        "),a("a",{staticClass:"select-clear",on:{click:t.clearSelectAll}},[t._v("清空")])])],1),a("Row",[a("Table",{ref:"table",attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data,sortable:"custom"},on:{"on-sort-change":t.changeSort,"on-selection-change":t.showSelect}}),a("Table",{ref:"exportTable",staticStyle:{display:"none"},attrs:{columns:t.allColumns,data:t.exportData}})],1),a("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:t.searchForm.pageNumber,total:t.total,"page-size":t.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1)],1)],1)],1)},n=[],r=(a("aa18"),a("982e"),a("1bc7"),a("365c")),i=a("23d5"),o=a.n(i),l={name:"article-manage",data:function(){return{accessToken:{},loading:!0,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",selectCount:0,selectList:[],category:[],selectDep:[],permTypes:[],tableColumnsChecked:["thumb","title","categoryTitle","status","createdAt"],searchForm:{title:"",content:"",status:null,startDate:"",endDate:"",summary:""},selectDate:null,modalType:0,columns:[],allColumns:[{title:"缩略图",key:"thumb",align:"center",minWidth:150,render:function(t,e){return e.row.thumb?t("div",{attrs:{style:""}},[t("img",{props:{type:"primary",size:"small"},attrs:{src:e.row.thumb,style:"width: 90px;height: 90px;border-radius: 2px;"},style:"text-align:center;margin:3px auto;"})]):t("div","-")}},{title:"标题",key:"title",sortable:!0,align:"center",minWidth:150},{title:"简介",key:"summary",sortable:!0,align:"center",type:"html",minWidth:250},{title:"分类",key:"categoryTitle",align:"center",minWidth:150,render:function(t,e){return""===e.row.categoryTitle?t("div","-"):t("div",e.row.categoryTitle)}},{title:"作者",key:"author",sortable:!0,minWidth:150,align:"center"},{title:"是否展示",key:"status",align:"center",minWidth:150,render:function(t,e){var a="";return 0===e.row.status?a="否":1===e.row.status&&(a="是"),t("div",a)},filters:[{label:"是",value:1},{label:"否",value:0}],filterMultiple:!1,filterMethod:function(t,e){return 0===t?0===e.status:1===t?1===e.status:void 0}},{title:"创建时间",key:"createdAt",sortable:!0,sortType:"desc",minWidth:150,render:function(t,e){return t("div",o()(1e3*e.row.createdAt).format("YYYY-MM-DD HH:mm:ss"))}}],data:[],exportData:[],total:0}},methods:{init:function(){this.accessToken={accessToken:this.getStore("accessToken")},this.changeTableColumns(),this.$refs.ueditor={},this.initMeta(),this.initCategoryData(),this.getArticleList()},initMeta:function(){var t=this.$route.meta.permTypes;null!==t&&void 0!==t&&(this.permTypes=t)},changePage:function(t){this.searchForm.pageNumber=t,this.getArticleList(),this.clearSelectAll()},changePageSize:function(t){this.searchForm.pageSize=t,this.getArticleList()},selectDateRange:function(t){t&&(this.searchForm.startDate=t[0],this.searchForm.endDate=t[1])},getArticleList:function(){var t=this;this.selectCount=0,this.loading=!0,Object(r["L"])(this.searchForm).then((function(e){t.loading=!1,!0===e.success&&(t.data=e.result.records,t.total=e.result.total)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getArticleList()},handleSearchExportAll:function(){var t=this,e=JSON.stringify(this.searchForm),a=JSON.parse(e);a.pageNumber=1,a.pageSize=1e9,Object(r["L"])(a).then((function(e){!0===e.success&&(t.exportData=e.result.records)}))},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.searchForm.categoryId="",this.getArticleList()},changeSort:function(t){this.searchForm.sort=t.key,this.searchForm.order=t.order,"normal"===t.order&&(this.searchForm.order=""),this.getArticleList()},handleDropdown:function(t){var e=this;if("exportData"===t){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要导出的数据");this.$Modal.confirm({title:"确认导出",content:"您确认要导出所选 "+this.selectCount+" 条数据?",onOk:function(){e.$refs.exportTable.exportCsv({filename:"文章数据"+o()().format("YYYYMMDDHHmmss"),columns:e.allColumns.filter((function(t,e){return e>0})),data:e.exportData.map((function(t){return t.createdAt=o()(1e3*t.createdAt).format("YYYY-MM-DD HH:mm:ss"),0===t.status?t.status="否":1===t.status&&(t.status="是"),t}))})}})}else"exportDataAll"===t?(this.handleSearchExportAll(),this.$Modal.confirm({title:"确认导出",content:"您确认要导出全部数据?",onOk:function(){e.exportData.length<=0?e.$Message.warning("没有数据需要导出"):e.$refs.exportTable.exportCsv({filename:"文章数据"+o()().format("YYYYMMDDHHmmss"),columns:e.allColumns.filter((function(t,e){return e>0})),data:e.exportData.map((function(t){return t.createdAt=o()(1e3*t.createdAt).format("YYYY-MM-DD HH:mm:ss"),0===t.status?t.status="否":1===t.status&&(t.status="是"),t}))})}})):"refresh"===t&&this.getArticleList()},add:function(){this.$router.push({name:"article_edit",query:{type:"add"}})},enable:function(t){var e=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用文章 "+t.title+" ?",onOk:function(){Object(r["F"])(t.id).then((function(t){!0===t.success&&(e.$Message.success("操作成功"),e.getArticleList())}))}})},disable:function(t){var e=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用文章 "+t.title+" ?",onOk:function(){Object(r["t"])(t.id).then((function(t){!0===t.success&&(e.$Message.success("操作成功"),e.getArticleList())}))}})},remove:function(t){var e=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除文章 "+t.title+" ?",onOk:function(){Object(r["k"])(t.id).then((function(t){!0===t.success&&(e.$Message.success("删除成功"),e.getArticleList())}))}})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},showSelect:function(t){this.exportData=t,this.selectList=t,this.selectCount=t.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},delAll:function(){var t=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var e="";t.selectList.forEach((function(t){e+=t.id+","})),e=e.substring(0,e.length-1),Object(r["k"])(e).then((function(e){!0===e.success&&(t.$Message.success("删除成功"),t.clearSelectAll(),t.getArticleList())}))}})},initCategoryData:function(){var t=this;Object(r["W"])(0).then((function(e){!0===e.success&&(e.result.forEach((function(t){t.isParent?(t.value=t.id,t.label=t.title,t.loading=!1,t.children=[]):(t.value=t.id,t.label=t.title)})),t.deleteDisableNode(e.result),t.category=e.result)}))},deleteDisableNode:function(t){var e=this;t.forEach((function(t){0===t.status&&(t.title="[已禁用] "+t.title,t.disabled=!0),t.children&&t.children.length>0&&e.deleteDisableNode(t.children)}))},loadData:function(t,e){var a=this;t.loading=!0,Object(r["W"])(t.value).then((function(s){t.loading=!1,!0===s.success&&(s.result.forEach((function(t){t.isParent?(t.value=t.id,t.label=t.title,t.loading=!1,t.children=[]):(t.value=t.id,t.label=t.title)})),a.deleteDisableNode(s.result),t.children=s.result,e())}))},loadDataTree:function(t,e){Object(r["W"])(t.id).then((function(t){!0===t.success&&(t.result.forEach((function(t){t.isParent&&(t.loading=!1,t.children=[])})),e(t.result))}))},selectTree:function(t){if(t.length>0){for(var e in t[0])null===t[0][e]&&(t[0][e]="");var a=JSON.stringify(t[0]),s=JSON.parse(a);this.articleForm.categoryId=s.id,this.articleForm.categoryTitle=s.title}},clearSelectDep:function(){this.articleForm.categoryId="",this.articleForm.categoryTitle=""},handleChangeDep:function(t,e){t&&t.length>0?this.searchForm.categoryId=t[t.length-1]:this.searchForm.categoryId=""},handleChangeUserFormDep:function(t,e){t&&t.length>0?this.articleForm.categoryId=t[t.length-1]:this.articleForm.categoryId=""},changeTableColumns:function(){this.columns=this.getTableColumns()},getTableColumns:function(){var t=this,e=[],a={type:"selection",align:"center",fixed:"left",minWidth:60};e.push(a);var s={title:"操作",key:"action",align:"center",fixed:"right",minWidth:200,render:function(e,a){var s,n,r,i;return t.permTypes.includes("edit")&&(s=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){var e=a.row.id;t.$router.push({name:"article_edit",query:{type:"edit",id:e}})}}},"编辑")),t.permTypes.includes("enable")&&(r=e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.enable(a.row)}}},"启用")),t.permTypes.includes("disable")&&(n=e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.disable(a.row)}}},"禁用")),t.permTypes.includes("delete")&&(i=e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.remove(a.row)}}},"删除")),1===a.row.status?e("div",[s,n,i]):e("div",[s,r,i])}},n=this;return this.allColumns.forEach((function(t){n.tableColumnsChecked.forEach((function(a){t.key===a&&e.push(t)}))})),e.push(s),e}},mounted:function(){this.init()}},c=l,u=(a("e007"),a("cba8")),h=Object(u["a"])(c,s,n,!1,null,null,null);e["default"]=h.exports}}]);